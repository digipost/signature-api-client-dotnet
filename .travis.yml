sudo: required
language: csharp
solution: api-client-shared.sln
mono: none
git:
  submodules: false
dotnet: 2.0.0
before_install:
  - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
  - git submodule update --init --recursive
  
  - ./travis-deploy/apt-get-add-keys-and-update.sh
  - ./travis-deploy/mono-install.sh
  - ./travis-deploy/nuget-install.sh
  - ./travis-deploy/version-patcher-install.sh
  - ./travis-deploy/nuspec-version-patcher.sh signature-api-client.nuspec
install:
  - dotnet restore
script:
  - dotnet build -c Release
  - dotnet test Digipost.Signature.Api.Client.Core.Tests/Digipost.Signature.Api.Client.Core.Tests.csproj
  - dotnet test Digipost.Signature.Api.Client.Direct.Tests/Digipost.Signature.Api.Client.Direct.Tests.csproj
  - dotnet test Digipost.Signature.Api.Client.Portal.Tests/Digipost.Signature.Api.Client.Portal.Tests.csproj
  - mono nuget.exe signature-api-client.nuspec -Verbosity detailed
  - ./travis-deploy/nuget-push.sh 

